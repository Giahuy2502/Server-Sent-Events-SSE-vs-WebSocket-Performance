<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>🚀 So sánh SSE vs WebSocket</title>
  <link rel="stylesheet" href="styles.css">
</head>
<<body>
  <div class="header">
    <h1>🚀 Dashboard so sánh SSE vs WebSocket</h1>
    <p>So sánh hiệu suất thời gian thực giữa Server-Sent Events và WebSocket</p>
  </div>

  <div class="status-bar">
    <div class="status-item" id="sseStatus">SSE: Connecting...</div>
    <div class="status-item" id="wsStatus">WebSocket: Connecting...</div>
  </div>

  <div class="main-dashboard">
    <!-- Panel SSE -->
    <div class="server-panel sse-panel">
      <div class="panel-header">
        <h2>Server-Sent Events (SSE)</h2>
        <div class="connection-status status-disconnected" id="sseConnectionStatus">Disconnected</div>
        <div class="connection-controls">
          <button class="connection-btn connect-btn" id="sseConnectBtn" onclick="connectSSE()">🔗 Connect</button>
          <button class="connection-btn disconnect-btn" id="sseDisconnectBtn" onclick="disconnectSSE()" disabled>❌ Disconnect</button>
        </div>
      </div>
      
      <div class="data-display">
        <div class="data-value" id="sseValue">--</div>
        <div class="data-time" id="sseTime">Đang chờ dữ liệu...</div>
      </div>
      
      <div class="metrics-grid">
        <div class="metric-box">
          <div class="metric-label">Connections</div>
          <div class="metric-value" id="sseConnections">0</div>
        </div>
        <div class="metric-box">
          <div class="metric-label">Messages</div>
          <div class="metric-value" id="sseMessages">0</div>
        </div>
        <div class="metric-box">
          <div class="metric-label">Throughput (msg/s)</div>
          <div class="metric-value" id="sseThroughput">0</div>
        </div>
        <div class="metric-box">
          <div class="metric-label">Uptime (s)</div>
          <div class="metric-value" id="sseUptime">0</div>
        </div>
      </div>
    </div>

    <!-- Panel WebSocket -->
    <div class="server-panel ws-panel">
      <div class="panel-header">
        <h2>WebSocket</h2>
        <div class="connection-status status-disconnected" id="wsConnectionStatus">Disconnected</div>
        <div class="connection-controls">
          <button class="connection-btn connect-btn" id="wsConnectBtn" onclick="connectWebSocket()">🔗 Connect</button>
          <button class="connection-btn disconnect-btn" id="wsDisconnectBtn" onclick="disconnectWebSocket()" disabled>❌ Disconnect</button>
        </div>
      </div>
      
      <div class="data-display">
        <div class="data-value" id="wsValue">--</div>
        <div class="data-time" id="wsTime">Đang chờ dữ liệu...</div>
      </div>
      
      <div class="metrics-grid">
        <div class="metric-box">
          <div class="metric-label">Connections</div>
          <div class="metric-value" id="wsConnections">0</div>
        </div>
        <div class="metric-box">
          <div class="metric-label">Messages</div>
          <div class="metric-value" id="wsMessages">0</div>
        </div>
        <div class="metric-box">
          <div class="metric-label">Throughput (msg/s)</div>
          <div class="metric-value" id="wsThroughput">0</div>
        </div>
        <div class="metric-box">
          <div class="metric-label">Uptime (s)</div>
          <div class="metric-value" id="wsUptime">0</div>
        </div>
      </div>
    </div>
  </div>

  <!-- So sánh hiệu suất -->
  <div class="performance-section">
    <h3>📊 So sánh hiệu suất</h3>
    <table class="comparison-table">
      <thead>
        <tr>
          <th>Metric</th>
          <th>SSE</th>
          <th>WebSocket</th>
          <th>Winner</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>CPU Usage (%)</td>
          <td id="sseCpuUsage">--</td>
          <td id="wsCpuUsage">--</td>
          <td id="cpuWinner">--</td>
        </tr>
        <tr>
          <td>Memory Usage (%)</td>
          <td id="sseMemoryUsage">--</td>
          <td id="wsMemoryUsage">--</td>
          <td id="memoryWinner">--</td>
        </tr>
        <tr>
          <td>Throughput (msg/s)</td>
          <td id="sseThroughputComp">--</td>
          <td id="wsThroughputComp">--</td>
          <td id="throughputWinner">--</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Kiểm tra độ trễ -->
  <div class="performance-section">
    <h3>⚡ Latency Testing</h3>
    <div class="latency-section">
      <div class="latency-box">
        <div class="metric-label">SSE Latency</div>
        <div class="latency-value" id="sseLatency">-- ms</div>
      </div>
      <div class="latency-box">
        <div class="metric-label">WebSocket Latency</div>
        <div class="latency-value" id="wsLatency">-- ms</div>
      </div>
    </div>
    
    <div class="controls">
      <button class="control-button" onclick="testLatency()">Test Latency</button>
      <button class="control-button" onclick="clearLogs()">Clear Logs</button>
    </div>
  </div>

  <!-- Nhật ký hoạt động -->
  <div class="performance-section">
    <h3>📝 Activity Log</h3>
    <div class="log-section" id="activityLog">
      <div>Dashboard đã được khởi tạo...</div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
  <script src="main.js"></script>
  <script src="sse-handler.js"></script>
  <script src="ws-handler.js"></script>
</body>
</html>